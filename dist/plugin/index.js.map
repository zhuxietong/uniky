{"version":3,"sources":["../../src/plugin/pages.defined.ts","../../src/plugin/global.defined.ts","../../src/plugin/index.ts"],"names":["path","fs","fs2","exports"],"mappings":"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","file":"index.js","sourcesContent":["import type { Plugin } from 'vite';\nimport fs from 'fs';\nimport path from 'path';\n\ninterface PagesJson {\n  pages?: Array<{\n    path: string;\n    [key: string]: any;\n  }>;\n  subPackages?: Array<{\n    root: string;\n    pages: Array<{\n      path: string;\n      [key: string]: any;\n    }>;\n  }>;\n  [key: string]: any;\n}\n\n/**\n * 移除 JSON 中的注释（支持 JSONC 格式）\n */\nfunction stripJsonComments(jsonString: string): string {\n  let result = '';\n  let inString = false;\n  let inSingleLineComment = false;\n  let inMultiLineComment = false;\n  let escapeNext = false;\n\n  for (let i = 0; i < jsonString.length; i++) {\n    const char = jsonString[i];\n    const nextChar = jsonString[i + 1];\n\n    // 处理转义字符\n    if (escapeNext) {\n      if (inString) {\n        result += char;\n      }\n      escapeNext = false;\n      continue;\n    }\n\n    if (char === '\\\\' && inString) {\n      result += char;\n      escapeNext = true;\n      continue;\n    }\n\n    // 处理字符串\n    if (char === '\"' && !inSingleLineComment && !inMultiLineComment) {\n      inString = !inString;\n      result += char;\n      continue;\n    }\n\n    // 如果在字符串内，直接添加字符\n    if (inString) {\n      result += char;\n      continue;\n    }\n\n    // 处理多行注释结束\n    if (inMultiLineComment) {\n      if (char === '*' && nextChar === '/') {\n        inMultiLineComment = false;\n        i++; // 跳过 '/'\n      }\n      continue;\n    }\n\n    // 处理单行注释结束\n    if (inSingleLineComment) {\n      if (char === '\\n' || char === '\\r') {\n        inSingleLineComment = false;\n        result += char; // 保留换行符\n      }\n      continue;\n    }\n\n    // 检测注释开始\n    if (char === '/') {\n      if (nextChar === '/') {\n        inSingleLineComment = true;\n        i++; // 跳过第二个 '/'\n        continue;\n      }\n      if (nextChar === '*') {\n        inMultiLineComment = true;\n        i++; // 跳过 '*'\n        continue;\n      }\n    }\n\n    // 正常字符\n    result += char;\n  }\n\n  return result;\n}\n\n/**\n * 从 pages.json 提取所有页面路径\n */\nfunction extractPagePaths(pagesJson: PagesJson): string[] {\n  const pagePaths: string[] = [];\n\n  // 提取主包页面\n  if (pagesJson.pages && Array.isArray(pagesJson.pages)) {\n    pagesJson.pages.forEach((page) => {\n      if (page.path) {\n        pagePaths.push(page.path);\n      }\n    });\n  }\n\n  // 提取分包页面\n  if (pagesJson.subPackages && Array.isArray(pagesJson.subPackages)) {\n    pagesJson.subPackages.forEach((subPackage) => {\n      const root = subPackage.root;\n      if (subPackage.pages && Array.isArray(subPackage.pages)) {\n        subPackage.pages.forEach((page) => {\n          if (page.path) {\n            const fullPath = `${root}/${page.path}`.replace(/\\/+/g, '/');\n            pagePaths.push(fullPath);\n          }\n        });\n      }\n    });\n  }\n\n  return pagePaths;\n}\n\n/**\n * 生成 TypeScript 代码\n */\nfunction generateTypeScriptCode(pagePaths: string[]): string {\n  const pagesArray = pagePaths.map((p) => `\"${p}\"`).join(', ');\n  \n  return `// Auto-generated by vite-plugin-pages-defined\n// Do not edit this file manually\n\nexport const _Pages = [${pagesArray}] as const;\nexport type _PagePath = typeof _Pages[number];\n\ntype RouteFunction = (path: _PagePath, options?: { query?: Record<string, any>, json?: Record<string, any> }) => void;\n\ninterface ToRouteInterface {\n  navigate: RouteFunction;\n  redirect: RouteFunction;\n  switchTab: RouteFunction;\n  reLaunch: RouteFunction;\n  back: (delta?: number) => void;\n}\n\nconst buildUrl = (path: string, query?: Record<string, any>, json?: Record<string, any>): string => {\n  const fullPath = path.startsWith('/') ? path : \\`/\\${path}\\`;\n  const params: string[] = [];\n  \n  if (query && Object.keys(query).length > 0) {\n    Object.entries(query).forEach(([key, value]) => {\n      params.push(\\`\\${encodeURIComponent(key)}=\\${encodeURIComponent(String(value))}\\`);\n    });\n  }\n  \n  if (json && Object.keys(json).length > 0) {\n    const jsonStr = JSON.stringify(json);\n    params.push(\\`json=\\${encodeURIComponent(jsonStr)}\\`);\n  }\n  \n  return params.length > 0 ? \\`\\${fullPath}?\\${params.join('&')}\\` : fullPath;\n};\n\nconst ToRoute: ToRouteInterface = {\n  navigate: (path, options) => {\n    const url = buildUrl(path, options?.query, options?.json);\n    uni.navigateTo({ url });\n  },\n  redirect: (path, options) => {\n    const url = buildUrl(path, options?.query, options?.json);\n    uni.redirectTo({ url });\n  },\n  switchTab: (path, options) => {\n    const url = buildUrl(path, options?.query, options?.json);\n    uni.switchTab({ url });\n  },\n  reLaunch: (path, options) => {\n    const url = buildUrl(path, options?.query, options?.json);\n    uni.reLaunch({ url });\n  },\n  back: (delta = 1) => {\n    uni.navigateBack({ delta });\n  }\n};\n\nexport const _To = ToRoute;\n`;\n}\n\n/**\n * 生成 pages.ts 文件\n */\nfunction generatePagesFile(srcDir: string, outputPath: string): void {\n  try {\n    const pagesJsonPath = path.resolve(srcDir, 'pages.json');\n    \n    // 读取 pages.json\n    if (!fs.existsSync(pagesJsonPath)) {\n      console.warn('[pages-defined] pages.json not found');\n      return;\n    }\n\n    const pagesJsonContent = fs.readFileSync(pagesJsonPath, 'utf-8');\n    // 移除 JSON 注释后再解析\n    const cleanedJson = stripJsonComments(pagesJsonContent);\n    const pagesJson: PagesJson = JSON.parse(cleanedJson);\n\n    // 提取所有页面路径\n    const pagePaths = extractPagePaths(pagesJson);\n\n    // 生成 TypeScript 代码\n    const code = generateTypeScriptCode(pagePaths);\n\n    // 确保输出目录存在\n    const outputDir = path.dirname(outputPath);\n    if (!fs.existsSync(outputDir)) {\n      fs.mkdirSync(outputDir, { recursive: true });\n    }\n\n    // 写入文件\n    fs.writeFileSync(outputPath, code, 'utf-8');\n    console.log(`[pages-defined] Generated ${outputPath} with ${pagePaths.length} pages`);\n  } catch (error) {\n    console.error('[pages-defined] Error generating pages.ts:', error);\n  }\n}\n\n/**\n * Vite 插件：从 pages.json 生成类型安全的路由定义\n */\nexport default function pagesDefinedPlugin(): Plugin {\n  let srcDir: string;\n  let outputPath: string;\n\n  return {\n    name: 'vite-plugin-pages-defined',\n    \n    configResolved(config) {\n      // 确定 src 目录和输出路径\n      srcDir = path.resolve(config.root, 'src');\n      outputPath = path.resolve(srcDir, 'autoGen/global/pages.ts');\n    },\n\n    buildStart() {\n      // 在构建开始时生成 pages.ts\n      generatePagesFile(srcDir, outputPath);\n    },\n\n    configureServer(server) {\n      // 监听 pages.json 文件变化\n      const pagesJsonPath = path.resolve(srcDir, 'pages.json');\n      \n      server.watcher.add(pagesJsonPath);\n      server.watcher.on('change', (file) => {\n        if (file === pagesJsonPath) {\n          console.log('[pages-defined] pages.json changed, regenerating pages.ts...');\n          generatePagesFile(srcDir, outputPath);\n        }\n      });\n\n      // 初始生成\n      generatePagesFile(srcDir, outputPath);\n    }\n  };\n}","// 该插件用于作为 vite.config.ts 中 作为插件；\n// 该插件用于收集 src/autoGen/global文件夹下的ts文件 所有export 导出的内容， 并将其合并为一个全局定义文件 src/autoGen/global.d.ts 文件 同时，生成一个 /src/autoGen/global.install.ts 文件.\n// 以便在项目中全局使用这些类型定义，避免了手动维护全局类型定义文件的麻烦。\n\nimport type { Plugin } from 'vite';\nimport * as fs from 'fs';\nimport * as path from 'path';\n\ninterface ExportInfo {\n  name: string;\n  type: 'function' | 'const' | 'class' | 'interface' | 'type' | 'enum';\n  isDefault: boolean;\n  filePath: string;\n}\n\nexport default function globalDefinedPlugin(): Plugin {\n  const globalDir = 'src/autoGen/global';\n  const globalDtsPath = 'src/autoGen/global.d.ts';\n  const installTsPath = 'src/autoGen/global.install.ts';\n\n  /**\n   * 递归获取目录下所有 .ts 文件（排除 .d.ts 和 install.ts）\n   */\n  function getTsFiles(dir: string): string[] {\n    const files: string[] = [];\n\n    if (!fs.existsSync(dir)) {\n      return files;\n    }\n\n    const entries = fs.readdirSync(dir, { withFileTypes: true });\n\n    for (const entry of entries) {\n      const fullPath = path.join(dir, entry.name);\n\n      if (entry.isDirectory()) {\n        files.push(...getTsFiles(fullPath));\n      } else if (entry.isFile() && entry.name.endsWith('.ts') && !entry.name.endsWith('.d.ts') && entry.name !== 'global.install.ts') {\n        files.push(fullPath);\n      }\n    }\n\n    return files;\n  }\n\n  /**\n   * 解析 TypeScript 文件，提取所有 export 的内容\n   */\n  function parseExports(filePath: string): ExportInfo[] {\n    const content = fs.readFileSync(filePath, 'utf-8');\n    const exports: ExportInfo[] = [];\n\n    // 匹配 export default\n    const defaultExportRegex = /export\\s+default\\s+(function|class|const|let|var)?\\s*([a-zA-Z_$][a-zA-Z0-9_$]*)?/g;\n    let match;\n\n    while ((match = defaultExportRegex.exec(content)) !== null) {\n      if (match[2]) {\n        exports.push({\n          name: match[2],\n          type: (match[1] as any) || 'const',\n          isDefault: true,\n          filePath\n        });\n      }\n    }\n\n    // 匹配 export function\n    const functionRegex = /export\\s+(?:async\\s+)?function\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = functionRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'function',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export const/let/var\n    const varRegex = /export\\s+(?:const|let|var)\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = varRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'const',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export class\n    const classRegex = /export\\s+(?:abstract\\s+)?class\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = classRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'class',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export interface\n    const interfaceRegex = /export\\s+interface\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = interfaceRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'interface',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export type\n    const typeRegex = /export\\s+type\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = typeRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'type',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export enum\n    const enumRegex = /export\\s+(?:const\\s+)?enum\\s+([a-zA-Z_$][a-zA-Z0-9_$]*)/g;\n    while ((match = enumRegex.exec(content)) !== null) {\n      exports.push({\n        name: match[1],\n        type: 'enum',\n        isDefault: false,\n        filePath\n      });\n    }\n\n    // 匹配 export { ... }\n    const namedExportRegex = /export\\s*{([^}]+)}/g;\n    while ((match = namedExportRegex.exec(content)) !== null) {\n      const names = match[1].split(',').map(n => n.trim().split(/\\s+as\\s+/)[0].trim());\n      for (const name of names) {\n        if (name) {\n          exports.push({\n            name,\n            type: 'const',\n            isDefault: false,\n            filePath\n          });\n        }\n      }\n    }\n\n    return exports;\n  }\n\n  /**\n   * 生成 global.d.ts 文件内容\n   */\n  function generateGlobalDts(allExports: ExportInfo[]): string {\n    const imports = new Map<string, Set<string>>();\n\n    // 按文件分组导出\n    for (const exp of allExports) {\n      const relativePath = path.relative('src/autoGen', exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, '');\n      if (!imports.has(relativePath)) {\n        imports.set(relativePath, new Set());\n      }\n      if (!exp.isDefault) {\n        imports.get(relativePath)!.add(exp.name);\n      }\n    }\n\n    let content = '// 自动生成的全局类型定义文件\\n';\n    content += '// 请勿手动修改\\n\\n';\n\n    // 生成 import 语句\n    for (const [filePath, names] of imports) {\n      if (names.size > 0) {\n        content += `import type { ${Array.from(names).join(', ')} } from './${filePath}';\\n`;\n      }\n    }\n\n    content += '\\n';\n\n    // 生成全局声明\n    content += 'declare global {\\n';\n\n    // 对于函数、常量、类等，添加到全局\n    const globalItems = allExports.filter(exp => !exp.isDefault && exp.type !== 'interface' && exp.type !== 'type');\n    if (globalItems.length > 0) {\n      for (const exp of globalItems) {\n        if (exp.type === 'function') {\n          content += `  const ${exp.name}: typeof import('./${path.relative('src/autoGen', exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, '')}').${exp.name};\\n`;\n        } else if (exp.type === 'const') {\n          content += `  const ${exp.name}: typeof import('./${path.relative('src/autoGen', exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, '')}').${exp.name};\\n`;\n        } else if (exp.type === 'class') {\n          content += `  const ${exp.name}: typeof import('./${path.relative('src/autoGen', exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, '')}').${exp.name};\\n`;\n        }\n      }\n    }\n\n    content += '}\\n\\n';\n    content += 'export {};\\n';\n\n    return content;\n  }\n\n  /**\n   * 生成 global.install.ts 文件内容\n   */\n  function generateInstallTs(allExports: ExportInfo[]): string {\n    const imports = new Map<string, { names: Set<string>; hasDefault: boolean; defaultName?: string }>();\n\n    // 按文件分组导出\n    for (const exp of allExports) {\n      const relativePath = './global/' + path.relative(path.join('src', 'autoGen', 'global'), exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, '');\n      if (!imports.has(relativePath)) {\n        imports.set(relativePath, { names: new Set(), hasDefault: false });\n      }\n      const importInfo = imports.get(relativePath)!;\n      if (exp.isDefault) {\n        importInfo.hasDefault = true;\n        importInfo.defaultName = exp.name;\n      } else if (exp.type !== 'interface' && exp.type !== 'type') {\n        importInfo.names.add(exp.name);\n      }\n    }\n\n    let content = '// 自动生成的全局安装文件\\n';\n    content += '// 请勿手动修改\\n\\n';\n\n    // 生成 import 语句\n    for (const [filePath, info] of imports) {\n      if (info.hasDefault && info.names.size > 0) {\n        content += `import ${info.defaultName}, { ${Array.from(info.names).join(', ')} } from '${filePath}';\\n`;\n      } else if (info.hasDefault) {\n        content += `import ${info.defaultName} from '${filePath}';\\n`;\n      } else if (info.names.size > 0) {\n        content += `import { ${Array.from(info.names).join(', ')} } from '${filePath}';\\n`;\n      }\n    }\n\n    content += '\\n';\n    content += '/**\\n';\n    content += ' * 安装全局定义\\n';\n    content += ' * 在 main.ts 中调用此函数以注册全局变量\\n';\n    content += ' */\\n';\n    content += 'export function installGlobals() {\\n';\n\n    // 将导出的内容挂载到 globalThis\n    const globalItems = allExports.filter(exp => exp.type !== 'interface' && exp.type !== 'type');\n    for (const exp of globalItems) {\n      const name = exp.isDefault ? (imports.get('./global/' + path.relative(path.join('src', 'autoGen', 'global'), exp.filePath).replace(/\\\\/g, '/').replace(/\\.ts$/, ''))?.defaultName || exp.name) : exp.name;\n      content += `  (globalThis as any).${exp.name} = ${name};\\n`;\n    }\n\n    content += '}\\n';\n\n    return content;\n  }\n\n  /**\n   * 生成所有文件\n   */\n  function generate() {\n    try {\n      const tsFiles = getTsFiles(globalDir);\n\n      if (tsFiles.length === 0) {\n        console.log('[globalDefined] 未找到任何 TypeScript 文件');\n        return;\n      }\n\n      // 收集所有导出\n      const allExports: ExportInfo[] = [];\n      for (const file of tsFiles) {\n        const exports = parseExports(file);\n        allExports.push(...exports);\n      }\n\n      if (allExports.length === 0) {\n        console.log('[globalDefined] 未找到任何导出');\n        return;\n      }\n\n      // 生成 global.d.ts\n      const dtsContent = generateGlobalDts(allExports);\n      fs.writeFileSync(globalDtsPath, dtsContent, 'utf-8');\n      console.log(`[globalDefined] 已生成 ${globalDtsPath}`);\n\n      // 生成 global.install.ts\n      const installContent = generateInstallTs(allExports);\n      fs.writeFileSync(installTsPath, installContent, 'utf-8');\n      console.log(`[globalDefined] 已生成 ${installTsPath}`);\n\n      console.log(`[globalDefined] 共处理 ${tsFiles.length} 个文件，${allExports.length} 个导出`);\n    } catch (error) {\n      console.error('[globalDefined] 生成失败:', error);\n    }\n  }\n\n  return {\n    name: 'vite-plugin-global-defined',\n\n    buildStart() {\n      // 构建开始时生成文件\n      generate();\n    },\n\n    configureServer(server) {\n      // 监听 src/autoGen/global 目录下的文件变化\n      server.watcher.add(globalDir);\n\n      server.watcher.on('change', (file) => {\n        if (file.includes('src/autoGen/global') && file.endsWith('.ts') && !file.endsWith('.d.ts') && !file.includes('global.install.ts')) {\n          console.log(`[globalDefined] 检测到文件变化: ${file}`);\n          generate();\n        }\n      });\n\n      server.watcher.on('add', (file) => {\n        if (file.includes('src/autoGen/global') && file.endsWith('.ts') && !file.endsWith('.d.ts') && !file.includes('global.install.ts')) {\n          console.log(`[globalDefined] 检测到新文件: ${file}`);\n          generate();\n        }\n      });\n\n      server.watcher.on('unlink', (file) => {\n        if (file.includes('src/autoGen/global') && file.endsWith('.ts') && !file.endsWith('.d.ts') && !file.includes('global.install.ts')) {\n          console.log(`[globalDefined] 检测到文件删除: ${file}`);\n          generate();\n        }\n      });\n    }\n  };\n}\n","// created by zhuxietong on 2026-01-30 16:37\nimport type { Plugin } from 'vite';\nimport pagesDefinedPlugin from './pages.defined';\nimport globalDefinedPlugin from './global.defined';\n\nexport interface UnikyPluginOptions {\n  enablePages?: boolean;\n  enableGlobal?: boolean;\n}\n\nexport function unikyPlugin(options: UnikyPluginOptions = {}): Plugin[] {\n  const { enablePages = true, enableGlobal = true } = options;\n\n  const plugins: Plugin[] = [];\n\n  if (enablePages) {\n    plugins.push(pagesDefinedPlugin());\n  }\n\n  if (enableGlobal) {\n    plugins.push(globalDefinedPlugin());\n  }\n\n  return plugins;\n}\n\nexport { pagesDefinedPlugin, globalDefinedPlugin };\n\nexport default unikyPlugin;"]}